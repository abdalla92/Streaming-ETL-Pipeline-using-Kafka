# Setup Kafka Environment

## 1: Download and extract Kafka
  Download Kafka by running the command below.
    
    wget https://archive.apache.org/dist/kafka/3.7.0/kafka_2.12-3.7.0.tgz

  Extract Kafka from the zip file by running the command below.
    
    tar -xzf kafka_2.12-3.7.0.tgz

  Note: This command creates a directory named kafka_2.12-3.7.0 in the current directory.


## 2: Configure KRaft and start server
  Change to the kafka_2.12-3.7.0 directory.
    
    cd kafka_2.12-3.7.0

  Generate a cluster UUID that will uniquely identify the Kafka cluster.
    
    KAFKA_CLUSTER_ID="$(bin/kafka-storage.sh random-uuid)"

  Note: The new cluster id generated will be used by the KRaft controller.

  KRaft requires the log directories to be configured. Run the following command to configure the log directories passing the cluster id.
    
    bin/kafka-storage.sh format -t $KAFKA_CLUSTER_ID -c config/kraft/server.properties

  Now that KRaft is configured, you can start the Kafka server by running the following command.
    
    bin/kafka-server-start.sh config/kraft/server.properties

  Note: You can be sure that the Kafka server started there is information generated that the server started successfully along with some additional messages, such as log loaded.

              
## 3: Start MySQL server and setup the database
  Connect to the MySQL server using the command below in the terminal. Make sure you use the password given to you when the MySQL server starts. Please make a note of the password because you will need it later.
    
    mysql --host=mysql --port=3306 --user=root --password=Replace your password

  Create a database named tolldata.
  At the mysql> prompt, run the command below to create the database.
    
    create database tolldata;

  Create a table named livetolldata with the schema to store the data generated by the traffic simulator.
  Run the following command to create the table:

    use tolldata;
    create table livetolldata(timestamp datetime,vehicle_id int,vehicle_type char(15),toll_plaza_id smallint);

  Note: This is the table where you will store all streamed data that comes from Kafka. Each row is a record of when a vehicle has passed through a certain toll plaza along with its type and anonymized id.

  Disconnect from the MySQL server.
    
    exit

## 4: Install the Python packages
  Install the Python module kafka-python. This Python module will help you to communicate with kafka server. It can used to send and receive messages from Kafka.
    
    pip3 install kafka-python

  Install the Python module mysql-connector-python using the pip command.
    
    pip3 install mysql-connector-python==8.0.31

  This Python module will help you to interact with MySQL server.
